<!--Le IF : formGroup peut être nulle car il est initialisé au moment du subscribe qui est asynchrone 
Asynchrone : cad le résultat de l'api ne vient pas tout de suite.
-->
@if(formGroup!=null) {
    <mat-card class="flex justify-center items-center p-8 rounded-xl shadow-md">
        <form [formGroup]="formGroup" (ngSubmit)="onSubmit()" class="w-full max-w-md space-y-6">
            <h2>Edit Todo</h2>
                <div>
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>title</mat-label>
                        <input  matInput formControlName="title" type="text" placeholder="title">
                    </mat-form-field>
                </div>
                <div>
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>Priorities</mat-label>
                        <mat-select formControlName="priorities">
                            @for (item of priorities; track item.number){
                                <mat-option [value]="item.number">{{item.number}}</mat-option>
                            }
                        </mat-select>
                    </mat-form-field>
                </div>
                <div>
                    <mat-form-field appearance="fill" class="w-full">
                        <mat-label>Choose a date</mat-label>
                        <input matInput formControlName="dueDate" [matDatepicker]="picker">
                        <mat-hint>MM/DD/YYYY</mat-hint>
                        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                      </mat-form-field>
                </div>
                <div>
                    <mat-form-field class="assigned-chip-list w-full" appearance="fill">
                        <mat-label>Member</mat-label>
                        <mat-chip-grid #chipGrid aria-label="Member">
                          @for (contact of selectedContacts; track $index) {
                            <mat-chip-row (removed)="remove(contact.id)">
                              {{contact.prenom}}
                              <button matChipRemove [attr.aria-label]="'remove ' + contact.prenom">
                                <mat-icon>cancel</mat-icon>
                              </button>
                            </mat-chip-row>
                          }
                        </mat-chip-grid>
                        <input
                        name="CurrentMember"
                        placeholder="Choose member..."
                        #MemberInput
                        [formControl]="currentMember"
                        [matChipInputFor]="chipGrid"
                        [matAutocomplete]="auto"
                        (input)="onCurrentContactChange(MemberInput.value)"/>
                        <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)">
                            @for (contact of filteredContacts; track contact) {
                                <mat-option [value]="contact.id">{{contact.prenom}}</mat-option>
                            }
                        </mat-autocomplete>
                      </mat-form-field>
                </div>
                <div>
                    <mat-form-field class="w-full" appearance="fill">
                        <mat-label>description</mat-label>
                        <textarea matInput placeholder="description..." formControlName="textarea"></textarea>
                    </mat-form-field>
                </div>
                <div>
                    <mat-checkbox formControlName="completed">Completed</mat-checkbox>
                </div>
                <div>
                    <mat-card-actions class="flex gap-4">
                        <button mat-raised-button type="submit">Save</button>
                        <button mat-button type="button" (click)="onCancel()">Cancel</button>
                    </mat-card-actions>
                </div>
        </form>
    </mat-card>

}
